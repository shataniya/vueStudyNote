function _makeMask(){if(DOM.get("#J_mask"))DOM.get("#J_mask").style.display="block";else{var e=document.createElement("div");e.id="J_mask",e.className="mask",e.style.width=DOM.viewportWidth()+"px",e.style.height=DOM.viewportHeight()+"px",document.body.appendChild(e),Event.on(window,"resize",function(){e.style.width=DOM.viewportWidth()+"px",e.style.height=DOM.viewportHeight()+"px"})}}function _maketip(e){var t=507,n=196;if(DOM.get("#J_maskTip"))DOM.get("#J_maskTip").style.display="block";else{var a=document.createElement("div");a.id="J_maskTip",a.className="masktip "+e,a.style.left=(DOM.viewportWidth()>t?(DOM.viewportWidth()-t)/2:0)+"px",a.style.top=(DOM.viewportHeight()>n?(DOM.viewportHeight()-n)/2:0)+"px",S.UA.ie&&6==S.UA.ie&&(a.style.position="absolute",a.style.top=(DOM.viewportHeight()>n?(DOM.viewportHeight()-n)/2+ +DOM.scrollTop():0)+"px",Event.on(window,"scroll",function(){a.style.top=(DOM.viewportHeight()>n?(DOM.viewportHeight()-n)/2+ +DOM.scrollTop():0)+"px"}));var i=document.createElement("div");i.className="tip-content","downloadNew"==e&&(i.innerHTML="亲，快来下载最新的UC浏览器，体验优质扩展吧~");var o=document.createElement("a");o.className="download-btn",o.href="//down2.uc.cn/pcbrowser/down.php?id=101&pid=4364",o.innerHTML="立即下载";var r=document.createElement("a");r.className="close-btn",Event.on(r,"click",function(){DOM.get("#J_mask").style.display="none",DOM.get("#J_maskTip").style.display="none"}),a.appendChild(i),a.appendChild(r),a.appendChild(o),document.body.appendChild(a),Event.on(window,"resize",function(){a.style.left=(DOM.viewportWidth()>t?(DOM.viewportWidth()-t)/2:0)+"px",a.style.top=(DOM.viewportHeight()>n?(DOM.viewportHeight()-n)/2:0)+"px"})}}function showDownloadNew(){_makeMask(),_maketip("downloadNew")}var UC=window.UC||{},logUrl="//track.uc.cn/";!function(){"use strict";var e=RegExp("[?&]f=([^&]*)").exec(location.search);window._paq=window._paq||[],window.logSearch=window.location.search,window.paramArr=[],""!==window.logSearch&&(window.logSearch=e?"?ch="+e[1]:"?ch="),window.logWrite=function(e,t,n){function a(e,t){return e&&Object.keys(e).forEach(function(n){t.push(["deleteCustomVariable",e[n],"page"])}),t}function i(e){var t={},n=e.split("; "),a=n.length,i=null,o=null,r=null,l=0;if(!e.length)return null;for(;l<a;l++)i=n[l].split("_ck:"),o=i[0],r=i[1],o="id"===o||"pg"===o?o:"ck_"+o,t[o]=r;return t}function o(e,t,n){var a=e,o=t,l=n,s=null,c=null,u=0,p=/^(http:\/\/|https:\/\/)/,h="",g="",m="",v=null;if(a){if("click"===a&&(l=o,o=a,a=null),l)c=l;else{s=a.getAttribute("data-ck");try{c=r.parse(s)}catch(w){c=i(s)}}Object.keys(c).forEach(function(e){"pg"===e?window._paq.push(["setDocumentTitle",c[e]]):(u++,d.push(u),window._paq.push(["setCustomVariable",u,e,c[e],"page"]))}),h=a&&a.href?a.href:"",h&&"#"!==h&&!p.test(h)&&(g=location.protocol+"//"+location.host+location.pathname,v=/\S+[\\\/]+/.exec(g),m=v?v[0]:".",h=m+"/"+h),window._paq.push(["trackLink",h||"#","link"])}}var r=JSON||window.JSON2,l=window.logUrl,s=window._logParam,c=window._paq,u=s.pageTitle,d=window.paramArr;c.push(["setSiteId",s.appid]),c.push(["setDocumentTitle",s.pageTitle]),c.push(["setTrackerUrl",l+"collect"+window.logSearch]),c=a(d,c),"view"===t||"view"===e?(c.push(["setCustomVariable",1,"sn",s.sn,"page"]),window._paq=c,window._paq.push(["trackPageView"])):"click"!==t&&"click"!==e||o(e,t,n),window._logParam.pageTitle=u,u=null},UC.logWrite={write:function(e,t,n){window.logWrite(e,t,n)}}}(),function(){"use strict";var e=document.createElement("script");e.type="text/javascript",e.defer=!0,e.async=!0,e.src="//g.alicdn.com/browser/uc-extension-center/0.0.9/scripts/uaest.js",e.crossOrigin="anonymous",document.body.appendChild(e)}();var S=KISSY,D=DOM=S.DOM,E=Event=S.Event,$=S.Node.all,isTao=!!("undefined"!=typeof chrome&&chrome.wow&&chrome.wow.extension&&chrome.wow.extension.showButton),entryDevMode='<div class="wow-extensions"><a href="chrome://extensions" target="_blank">进入开发者模式 &gt;</a></div>',CATEGORY={},CATEGORYID={},CATEGORYCN={},menuArr=[{text:"首页",en:"recommendation",value:"0"},{text:"全部分类",en:"all",value:"-1"},{text:"实用工具",en:"tools",value:"1"},{text:"社交网络",en:"sns",value:"2"},{text:"生活服务",en:"life",value:"3"},{text:"页面增强",en:"web",value:"4"},{text:"广告过滤",en:"adblock",value:"5"},{text:"其它",en:"other",value:"6"}];window.onerror=function(e){e&&"string"==typeof e&&"Script error."===e&&util.log({ck_name:"error",ck_rg:e})},window.console||(window.console={log:function(){}});var util={pageLog:function(){window._logParam={appid:"27cc17ce0da9",pageTitle:"UC扩展中心",sn:0},window._paq=window._paq||[],UC.logWrite.write(this,"view")},log:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=encodeURIComponent(e[n]));UC.logWrite.write("click",t)},pluginCategory:function(e){for(var t="",n="",a=0;a<e.length;a++)CATEGORY[e[a].value]=e[a].en,CATEGORYCN[e[a].value]=e[a].text,CATEGORYID[e[a].en]=e[a].value,n=0===a?"recommend":"category",t+='<li class="'+n+'" data-id="'+e[a].value+'"><a href="#">'+e[a].text+"</a></li>";t=D.create(t),D.get("#J_Menu").appendChild(t)},goTop:function(){0==D.scrollTop()?document.getElementById("J_goTop").style.display="none":document.getElementById("J_goTop").style.display="block"},getLocationSearchValue:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?n[2]:null},ascendSort:function(e,t){return e.length>1&&e.sort(function(e,n){var a=parseInt(e[t],10),i=parseInt(n[t],10);return a-i}),e},reduceSort:function(e,t){return e.length>1&&e.sort(function(e,n){var a=parseInt(e[t]),i=parseInt(n[t]);return i-a}),e},hashCode:function(e){var t=0,n=e.length,a=0;if(0===n)return t;for(var i=0;i<n;i++)a=e.charCodeAt(i),t=(t<<5)-t+a,t&=t;return t},calGrade:function(e){var t,n=CRX.lists;return e.forEach(function(e,a){t=e;var i=util.hashCode(t.id),o=Math.abs(i%5)/10,r=o+9;r=r.toFixed(1),t.starNum=r,t.starWidth=(r>=9.3?65:57)+"px",t.index=a+1,n.forEach(function(e){e===t.id&&(t.install=!0)})}),e},appCalGrade:function(e,t){var n;n=t?t:e.dataset.extid;var a=util.hashCode(n),i=Math.abs(a%5)/10,o=i+9;o=o.toFixed(1),e.querySelector(".mod-star-num").innerText=o,e.querySelector(".mod-star-cover").style.width=(o>=9.3?65:57)+"px"},defaultCalGrade:function(e){Array.prototype.forEach.call(e,function(e){util.appCalGrade(e)})},getNewExtensions:function(e){var t,n,a,i=e,o=[],r=i.length;if(i.length>0)for(i.sort(function(e,t){var n=e,a=t;return n.name.localeCompare(a.name)}),t=0;t<r;t++)n=i[t],n.isApp||"theme"===n.type||(n.icons?(a=n.icons.length,n.icon=n.icons[a-1].url):n.icon=util.setIcon(n.id),o.push(n));return o},setIcon:function(e){return"chrome://extension-icon/"+e+"/72/1"},insertNoInstallExtNode:function(e){return'<div class="recommend-head"><a href="#!category/all">更多 &gt;</a><h2>为你推荐</h2><p class="no-tips-text1">你还没有安装扩展呢~<p class="no-tips-text2">下载一个试试喽</p></div>'+e},insertFootTipsNode:function(e){var t=DOM.create('<a class="noMore" href="javascript:void(0)">UC扩展中心因你而精彩，更多精品扩展敬请期待！</a>');return e&&(t=DOM.create('<a class="more" href="javascript:void(0)">加载更多</a>')),t},positionFooter:function(){var e=window.innerHeight,t=document.getElementsByClassName("page")[0].offsetHeight,n=116;e>t+n?document.getElementById("footerbg").style.bottom="0px":document.getElementById("footerbg").style.bottom="auto"},itemLog:function(e,t,n){var a="";if(t)if(null===n)a=e.one(t).parent("#J_Result")[0].classList.contains("no-result")?"搜索页-热门推荐":"搜索页-搜索结果";else if(0===parseInt(n)){var i=e.one(t)[0].classList;a=i.contains("mod-large")?"首页-轮播图":i.contains("rank-item")||i.contains("rank-btn")?"首页-"+document.querySelector(".rank-head .active").innerHTML:"首页-扩展分类"}else a=parseInt(n)===-2?"我的扩展-热门推荐":CATEGORYCN[n];else a="详情页链接";return a}},isPre=util.getLocationSearchValue("env");util.pluginCategory(menuArr);var barShow=!1,setMovingBar=function(e){var t=S.all("#J_Menu li");if(D.removeClass("#J_Menu_my","active"),D.removeClass("#J_Search","searching"),e=Number(e),t.removeClass("active"),e===-2){var n=1115,a=S.one("#J_Menu_my");a.addClass("active"),barShow?S.Anim("#J_MovingBar",{left:n+"px"},.2).run():S.one("#J_MovingBar").css({left:n+"px"}),barShow=!0}else for(var i=196,o=90,r=0;r<t.length;r++){var a=S.one(t[r]),l=Number(a.attr("data-id")),n="";l==e&&(a.addClass("active"),0===l?n=i:l==-1?n=i+o:l>0&&(n=i+o*(l+1)),barShow?S.Anim("#J_MovingBar",{left:n+"px"},.2).run():S.one("#J_MovingBar").css({left:n+"px"}),barShow=!0)}S.one("#J_MovingBar").show()},CRX={api:function(e){switch(e){case"search":a="/extensions/searchNew.do";break;case"plugin":a="/extensions/getPluginInfo.do";break;default:a="/extensions/getPluginListNew.do"}return a},tmsApi:{url:"//tce.alicdn.com/api/data.htm?ids=410495",id:"410495"},lists:[],curActiveHash:"0",curDetailItem:null,curDetailStatus:!1,tmsList:{},updateLists:function(){var e=[];isTao&&chrome.management.getAll(function(t){if(t.length>0)for(var n=0;n<t.length;n++)e.push(t[n].id)}),this.lists=e},path:{},update:function(){var e=this;e.path.hashNext&&e.path.loaded&&(e.path.loaded=!1,"search"===e.path.type?S.use("xtemplate",function(t,n){var a=e.api("search")+"?pageNumber="+e.path.page+"&pageSize="+e.path.pageSize+"&keyword="+e.path.keyword+"&t="+t.now();t.io.get(a,function(a){var i=t.one("#J_Result")[0],o=i.lastChild;i.removeChild(o),a=t.JSON.parse(a),e.path={type:"search",page:++e.path.page,pageSize:16,hashNext:a.hashNext,keyword:e.path.keyword};for(var r=e.lists,l=a.pluginList.length,s=0;s<l;s++)for(var c=a.pluginList[s].appid,u=0;u<r.length;u++)r[u]===c&&(a.pluginList[s].install=!0);var d=new n(t.one("#app_tmpl").html()).render(a);t.one("#J_Result").append(d),e.path.loaded=!0,setTimeout(function(){var e=KISSY.DOM.query("#J_Result .single-con");util.defaultCalGrade(e)},10),i.appendChild(util.insertFootTipsNode(a.hashNext)),util.positionFooter()})}):S.use("xtemplate",function(t,n){var a=e.api()+"?pageNumber="+e.path.page+"&pageSize="+e.path.pageSize+"&type="+e.path.typeid+"&t="+t.now();t.io.get(a,function(a){var i=t.one("#J_Category")[0],o=i.lastChild;i.removeChild(o),a=t.JSON.parse(a),e.path={type:"list",page:++e.path.page,pageSize:16,hashNext:a.hashNext,typeid:e.path.typeid};for(var r=e.lists,l=a.pluginList.length,s=0;s<l;s++)for(var c=a.pluginList[s].appid,u=0;u<r.length;u++)r[u]===c&&(a.pluginList[s].install=!0);var d=new n(t.one("#app_tmpl").html()).render(a);t.one("#J_Category").append(d),e.path.loaded=!0,setTimeout(function(){var e=KISSY.DOM.query("#J_Category .single-con");util.defaultCalGrade(e)},10),i.appendChild(util.insertFootTipsNode(a.hashNext)),util.positionFooter()})}))},getArrayItem:function(e,t){for(var n,a=[],i=S.clone(e),o=i.length,r=o>t?t:o,l=0;l<r;l++)n=Math.floor(Math.random()*i.length),a.push(i[n]),i.splice(n,1);return a}};"pre"===isPre&&(CRX.tmsApi.url+="&env=pre"),E.on(window,"scroll",function(e){if(CRX.path.hashNext===!0&&CRX.path.loaded){var t=D.viewportHeight(),n=S.one("#J_Main").height(),a=D.scrollTop();n<a+t-70&&CRX.update()}}),S.use("dom, event",function(e,t,n){}),S.use("event,switchable,datalazyload",function(e,t,n){var a=e.DOM;e.ready(function(e){var n=a.viewportWidth(),i=a.viewportHeight(),o=(a.docWidth(),a.docHeight(),939),r=541,l=(a.scrollTop(),"排行榜");a.css("#J_PopupCon",{left:n>o?(n-o)/2+20:0,top:i>r?(i-r)/3:0}),t.on("#J_Rank_week","click",function(t){var n=S.all(t.currentTarget);DOM.removeClass(".rank-head li","active"),DOM.removeClass(".recommend-rank","active"),n.addClass("active"),S.all(e.query(".recommend-rank")[0]).addClass("active"),util.log({ck_name:l,ck_rg:"周排行"})}),t.on("#J_Rank_month","click",function(t){var n=S.all(t.currentTarget);DOM.removeClass(".rank-head li","active"),DOM.removeClass(".recommend-rank","active"),n.addClass("active"),S.all(e.query(".recommend-rank")[1]).addClass("active"),util.log({ck_name:l,ck_rg:"月排行"})}),t.on(window,"resize",function(){var t=a.viewportWidth(),n=a.viewportHeight(),i=a.docWidth(),o=a.docHeight(),r=e.one("#J_PopupCon").width(),l=e.one("#J_PopupCon").height();a.css("#J_Popup",{width:i,height:o}),a.css("#J_PopupCon",{left:t>r?(t-r)/2+20:0,top:n>l?(n-l)/3:0}),util.positionFooter()}),util.positionFooter()})}),isTao?(CRX.updateLists(),chrome.management.onDisabled.addListener(function(e){if("theme"!==e.type)for(var t=e.id,n=S.all("#J_MyExtensions .mod-single"),a=0;a<n.length;a++){var i=S.one(n[a]),o=i.attr("data-extid");o===t&&(i.addClass("mod-enable"),i.one(".btn-enable .my-btn").replaceClass("disableBtn","enableBtn"),i.one(".btn-enable .my-btn").text("启用"),1!=e.actionType&&i.one(".btn-show").hide(),e.optionsUrl&&i.one(".btn-setting").hide())}}),chrome.management.onEnabled.addListener(function(e){if("theme"!==e.type)for(var t=e.id,n=S.all("#J_MyExtensions .mod-single"),a=0;a<n.length;a++){var i=S.one(n[a]),o=i.attr("data-extid");o===t&&(i.removeClass("mod-enable"),i.one(".btn-enable .my-btn").replaceClass("enableBtn","disableBtn"),i.one(".btn-enable .my-btn").text("禁用"),1==e.actionType&&i.one(".btn-show").show(),e.optionsUrl&&i.one(".btn-setting").show())}}),chrome.management.onInstalled.addListener(function(e){var t=e.id;chrome.management.getAll(function(e){if(0!=e.length){var t=[];e.sort(function(e,t){return e.name.localeCompare(t.name)});for(var n=0;n<e.length;n++)if(!e[n].isApp&&"theme"!==e[n].type){if(e[n].icons){var a=e[n].icons;e[n].icon=a[a.length-1].url}else e[n].icon=util.setIcon(e[n].id);t.push(e[n])}t.length>0&&S.use("xtemplate",function(e,n){var a=new n(e.one("#my_app").html()).render({extensions:t});e.one("#J_MyExtensions").removeClass("no-extensions"),e.one("#J_MyExtensions").html(a+entryDevMode),util.positionFooter();var i=KISSY.DOM.query("#J_MyExtensions .mod-single");util.defaultCalGrade(i)})}});for(var n=S.all(".single-btn"),a=0;a<n.length;a++){var i=S.one(n[a]),o=i.attr("data-extid");o===t&&(i.replaceClass("install","installed"),i.text("已安装"),i.removeClass("ing"))}CRX.updateLists()}),chrome.management.onUninstalled.addListener(function(e){for(var t=e,n=S.all("#J_MyExtensions .mod-single"),a=n.length,i=0;i<a;i++){var o=S.one(n[i]),r=o.attr("data-extid");r===t&&o.remove()}1===a&&S.use("xtemplate",function(e,t){e.io({url:CRX.tmsApi.url,dataType:"jsonp",jsonp:"callback",success:function(n){var a=n[CRX.tmsApi.id].value||{},i=a.extension_recommend||[];e.one("#J_Result").addClass("no-result"),i=util.calGrade(util.ascendSort(i,"position"));var o=CRX.getArrayItem(i,8);o=new t(e.one("#recommend_tmpl").html()).render({pluginList:o}),o=util.insertNoInstallExtNode(o),e.one("#J_MyExtensions").addClass("no-extensions"),e.one("#J_MyExtensions").html(o),util.positionFooter()},error:function(e){}})});for(var l=S.all(".single-btn"),i=0;i<l.length;i++){var o=S.one(l[i]),r=o.attr("data-extid");r===t&&(o.replaceClass("installed","install"),o.text("安装"))}CRX.updateLists()}),chrome.wow.extension.onIconVisibilityChanged.addListener(function(e,t){for(var n=S.all("#J_MyExtensions .mod-single"),a=0;a<n.length;a++){var i=S.one(n[a]),o=i.attr("data-extid");if(o===e){var r=S.one(".btn-show",i).one("input");t?r.attr("checked","checked"):r.removeAttr("checked")}}}),chrome.wow.extension.onInstallationCanceled.addListener(function(){var e=S.all(".single-btn.ing");e.text("安装"),e.removeClass("ing"),e.attr("data-disabled","false")}),chrome.wow.extension.onTerminated.addListener(function(){chrome.management.getAll(function(e){e.forEach(function(e){if("theme"!=e.type&&e.isTerminated){var t=e.id,n=KISSY.one('#J_MyExtensions li.mod-single[data-extid="'+t+'"] .btn-enable > .my-btn');n.text("重新启用"),n.addClass("reloadBtn")}})})})):S.all("#J_Menu_my").hide(),KISSY.add("CrxModel",function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}return e.extend(n,t.Model),n},{requires:["mvc"]}),KISSY.add("CategoryView",function(e,t,n,a){function i(){i.superclass.constructor.apply(this,arguments);var t=this;t.get("el");t.set("el","#J_Main"),t.set("container",e.one("#J_Category",t.get("el"))),t.set("searchInput",e.one("#J_Search_input")),t.set("searchBtn",e.one("#J_Search_btn"));var n="/plugins/getPluginList.do";window.location.host.indexOf("taobao.net")!=-1&&window.location.host.indexOf("taobao.com")!=-1||(n="ajax/extensions/lists.php"),t.set("api",n)}t.all,e.DOM,e.Event,a(e.Node.all("#app_tmpl").html());return e.extend(i,n.View,{render:function(){}}),i},{requires:["node","mvc","xtemplate"]}),KISSY.add("CrxView",function(e,t,n){function a(){a.superclass.constructor.apply(this,arguments);var t=this;t.get("el");t.set("el","#J_Main"),t.set("container",e.one("#J_Category",t.get("el"))),t.set("searchInput",e.one("#J_Search_input")),t.set("searchBtn",e.one("#J_Search_btn"))}var i=t.all;e.DOM,e.Event;return e.extend(a,n.View,{search:function(t){if(t&&t.halt(),D.removeClass("#J_Search","init"),D.removeClass("#J_Search","init-after"),D.addClass("#J_Search","searching"),D.query("#J_Search_input")[0].focus(),e.trim(this.get("searchInput").val())){var a=this.get("searchInput").val();util.log({ck_name:"首部导航",ck_rg:"搜索",ck_search:a}),n.Router.navigate("search="+encodeURIComponent(a))}},search_input:function(t){var n=t.currentTarget;if("focusin"===t.type)D.addClass("#J_Search","searching"),n.focus();else if("focusout"===t.type){var a=e.trim(n.value);""===a&&(n.value="",D.removeClass("#J_Search","searching"))}else if("keyup"===t.type){var i=t.keyCode;13===i&&(t.halt(),this.search())}},getCategory:function(e){var t=i(e.currentTarget).parent(),a=t.attr("data-id");if(a>menuArr.length-2)return!0;var o=CATEGORY[a];n.Router.navigate("category/"+o),e.halt()},my:function(e){n.Router.navigate("my/extensions"),e.halt()},hot:function(e){n.Router.navigate("hot/recommendation"),e.halt()}},{ATTRS:{el:{value:"#J_Aside"},events:{value:{"#J_Search_input":{focusin:"search_input",focusout:"search_input",keyup:"search_input"},"#J_Search_btn":{click:"search"},".menu-my a":{click:"my"},".recommend a":{click:"hot"},".category a":{click:"getCategory"}}}}}),a},{requires:["node","mvc"]}),KISSY.add("DetailExtView",function(e,t,n,a){function i(){i.superclass.constructor.apply(this,arguments);var e=this;e.get("el");e.set("el","#J_Main")}var o=t.all;e.DOM,e.Event;return e.extend(i,n.View,{hidedetail:function(t){t.halt(),CRX.curDetailStatus=!1,window.carousel&&window.carousel.stop(),e.one("#J_Popup").hide(),window.popupHide=!0;for(var a=e.all("#J_Menu li"),i=0;i<a.length;i++)if(target=o(a[i]),target.hasClass("active")){var r=target.attr("data-id"),l=CATEGORY[r];r==-2?n.Router.navigate("my/"+l):0==r?n.Router.navigate("hot/"+l):n.Router.navigate("category/"+l)}a.hasClass("active")||n.Router.navigate("search="+encodeURIComponent(CRX.path.keyword))},detailInstallLog:function(t){var n=o(t),a=util.itemLog(e,CRX.curDetailItem,CRX.curActiveHash);util.log({ck_name:"详情页安装按钮",ck_rg:a,app_id:n.attr("data-extid"),app_name:n.attr("data-extname")})},install:function(t){if(t.halt(),isTao){if(target=o(t.currentTarget),target.hasClass("ing"))return;if(this.detailInstallLog(target),"true"===target.attr("data-disabled"))return void t.halt();target.attr("data-disabled","true");var n=target.attr("data-extid"),a=CRX.api("plugin")+"?appid="+n+"&t="+e.now();e.io.get(a,function(t){t=e.JSON.parse(t),t.pluginList[0].filePath&&(window.open(t.pluginList[0].filePath,"_self"),target.text("安装中..."),target.addClass("ing"))})}else showDownloadNew()},installed:function(e){e.halt();var t=o(l.currentTarget);t.attr("data-disabled","false")}},{ATTRS:{el:{value:"#J_Popup"},events:{value:{".close":{click:"hidedetail"},".popup-bg":{click:"hidedetail"},".install":{click:"install"},".installed":{click:"installed"}}}}}),i},{requires:["node","mvc"]}),KISSY.add("DetailView",function(e,t,n,a){function i(){i.superclass.constructor.apply(this,arguments);var e=this;e.get("el")}var o=t.all;e.DOM,e.Event;return e.extend(i,n.View,{showDetailLog:function(t){var n=o(t),a=util.itemLog(e,t,CRX.curActiveHash);util.log({ck_name:"展开详情页",ck_rg:a,app_id:n.attr("data-extid"),app_name:n.attr("data-extname")})},showdetail:function(e){var t=e.currentTarget,a=o(t).attr("data-extid");t.querySelector(".ing")||(e.halt(),this.showDetailLog(t),CRX.curDetailItem=t,n.Router.navigate("detail/"+a))},installLog:function(t){var n=o(t),a=util.itemLog(e,t,CRX.curActiveHash);util.log({ck_name:"安装按钮",ck_rg:a,app_id:n.attr("data-extid"),app_name:n.attr("data-extname")})},install:function(t){if(t.halt(),isTao){if(target=o(t.currentTarget),target.hasClass("ing"))return;this.installLog(target),"true"==target.attr("data-disabled")&&t.halt();var n=target.attr("data-extid"),a=CRX.api("plugin")+"?appid="+n+"&t="+e.now();e.io.get(a,function(t){t=e.JSON.parse(t),t.pluginList[0]&&t.pluginList[0].filePath?(window.open(t.pluginList[0].filePath,"_self"),target.text("安装中..."),target.addClass("ing")):alert("未查询到该扩展！")})}else showDownloadNew()},installed:function(e){e.halt();var t=o(e.currentTarget);t.attr("data-disabled","false")}},{ATTRS:{el:{value:"#J_Main"},events:{value:{".rank-item":{click:"showdetail"},".mod-large":{click:"showdetail"},".single-item":{click:"showdetail"},".mod-item":{click:"showdetail"},".single-con":{click:"showdetail"},".rank-item .install":{click:"install"},".single-item .install":{click:"install"},".mod-single .install":{click:"install"},".mod-item .install":{click:"install"},".extensions-info .installed":{click:"installed"},".mod-single .installed":{click:"installed"}}}}}),i},{requires:["node","mvc","xtemplate"]}),KISSY.add("MyappView",function(e,t,n,a){function i(){i.superclass.constructor.apply(this,arguments);var e=this;e.get("el");e.set("el","#J_Main")}var o=(t.all,e.DOM);e.Event,a(e.Node.all("#app_tmpl").html());return e.extend(i,n.View,{show:function(e){var t=e.currentTarget;o.addClass(t,"hover")},hide:function(e){var t=e.currentTarget;o.removeClass(t,"hover")},trigger:function(t){t.halt();var n=e.one(t.currentTarget),a=n.parent(".mod-single"),i=a.attr("data-extid"),o=n.parent("li");if(o.hasClass("btn-show")){var r=n.first()[0].checked;chrome.wow.extension.showButton(i,r)}else if(o.hasClass(".btn-uninstall"))chrome.wow.extension.uninstall(i);else if(o.hasClass(".btn-setting"))chrome.wow.extension.openOptions(i);else if(n.parent().hasClass("btn-enable")){var l=!0;if(n.hasClass("reloadBtn"))return chrome.wow.extension.reload(i),void n.removeClass("reloadBtn");n.hasClass("enableBtn")?l=!0:n.hasClass("disableBtn")&&(l=!1),chrome.management.setEnabled(i,l)}}},{ATTRS:{el:{value:"#J_MyExtensions"},events:{value:{".mod-single":{mouseenter:"show",mouseleave:"hide"},"span.my-btn":{click:"trigger"},"a.my-btn":{click:"trigger"},"label.my-btn":{change:"trigger"},".btn-enable .my-btn":{click:"trigger"}}}}}),i},{requires:["node","mvc","xtemplate"]}),KISSY.add("SearchView",function(e,t,n,a){function i(){i.superclass.constructor.apply(this,arguments);var t=this;t.get("el");t.set("el","#J_Main"),t.set("container",e.one("#J_Category",t.get("el"))),t.set("searchInput",e.one("#J_Search_input")),t.set("searchBtn",e.one("#J_Search_btn"));var n="/plugins/getPluginList.do";window.location.host.indexOf("taobao.net")!=-1&&window.location.host.indexOf("taobao.com")!=-1||(n="ajax/extensions/lists.php"),t.set("api",n)}t.all,e.DOM,e.Event,a(e.Node.all("#app_tmpl").html());return e.extend(i,n.View,{render:function(){}}),i},{requires:["node","mvc","xtemplate"]}),KISSY.add("CrxCollection",function(e,t,n){function n(){n.superclass.constructor.apply(this,arguments)}return e.extend(n,t.Collection,{ATTRS:{model:{value:n}}}),n},{requires:["mvc","CrxModel"]}),KISSY.add("crx/main",function(e,t,n,a){new a,n.Router.start({triggerRoute:!0,urlRoot:location.pathname})},{requires:["node","mvc","CrxRouter"]}),KISSY.use("crx/main"),KISSY.add("CrxRouter",function(e,t,n,a,i,o,r,l,s,c,u,d){function p(){var e=this;p.superclass.constructor.apply(e,arguments),e.CrxView=new o({crx:new r}),e.searchView=new l,e.categoryView=new s,e.detailView=new c,e.detailExtView=new u,e.myappView=new d}var h=(e.Node.all,e.DOM);return e.extend(p,t.Router,{initialize:function(){},viewsearch:function(t){if(window.carousel&&window.carousel.stop(),window.popupHide)return void(window.popupHide=!1);document.body.scrollTop=0,CRX.curActiveHash=null,e.one("#J_Popup").hide();var a=this.CrxView,t=decodeURIComponent(t.keyword);CRX.path.keyword=t,e.one("#J_Search").removeClass("init"),e.one("#J_Search").removeClass("init-after"),a.get("searchInput").val(t);var i=CRX.api("search")+"?pageNumber=1&pageSize=16&keyword="+t+"&t="+e.now(),o=CRX.lists;e.io({url:i,type:"get",success:function(a){a=e.JSON.parse(a),CRX.path={type:"search",page:2,pageSize:16,hashNext:a.hashNext,keyword:t};for(var i=a.pluginList.length,r=0;r<i;r++)for(var l=a.pluginList[r].appid,s=0;s<o.length;s++)o[s]===l&&(a.pluginList[r].install=!0);if(i){e.one("#J_Result").removeClass("no-result");var c=new n(e.one("#app_tmpl").html()).render(a),c="<h4>搜索到<span> "+a.total+" </span>条结果</h4>"+c;if(e.one("#J_Result").html(c),setTimeout(function(){var e=KISSY.DOM.query("#J_Result .single-con");util.defaultCalGrade(e)},10),CRX.path.loaded=!0,a.hashNext===!0){var u=h.viewportHeight(),d=e.one("#J_Main").height(),p=h.scrollTop();d<p+u-70&&CRX.update()}e.one("#J_Result")[0].appendChild(util.insertFootTipsNode(a.hashNext))}else e.io({url:CRX.tmsApi.url,dataType:"jsonp",jsonp:"callback",success:function(t){var a=t[CRX.tmsApi.id].value||{},i=a.extension_recommend||[],o=i.length,r=[];if(e.one("#J_Result").addClass("no-result"),i=util.calGrade(util.ascendSort(i,"position")),0===o)e.one("#J_Result").html("");else{for(var l=0;l<o;l++)i[l].installed!==!0&&r.push(i[l]);var s=CRX.getArrayItem(r,8);s=new n(e.one("#recommend_tmpl").html()).render({pluginList:s}),s='<div class="recommend-head"><a href="#!category/all">都不喜欢，这里还有 ></a><h2>为你推荐</h2><p class="no-tips-text1">Sorry，没有找到相关内容~</p><p class="no-tips-text2">试试下面的推荐吧</p></div>'+s,e.one("#J_Result").html(s)}D.addClass("#J_Search","searching"),util.positionFooter()},error:function(e){}});window.carousel_main&&window.carousel_main.stop(),e.all("#J_Main .main-lists").hide(),e.one("#J_Result").show(),e.one("#J_MovingBar").hide();var g=e.all("#J_Menu li");g.removeClass("active"),util.positionFooter()},error:function(){}}),util.positionFooter()},viewcategory:function(t){if(window.popupHide)return void(window.popupHide=!1);document.body.scrollTop=0;var t=decodeURIComponent(t.type),a=CATEGORYID[t];CRX.curActiveHash=a,setMovingBar(a),window.carousel&&window.carousel.stop(),e.one("#J_Popup").hide(),e.one("#J_Search_input").val(""),e.one("#J_Search").addClass("init"),e.one("#J_Search").addClass("init-after");var i=CRX.api()+"?pageNumber=1&pageSize=16&type="+a+"&t="+e.now(),o=CRX.lists;e.io({url:i,type:"get",success:function(t){t=e.JSON.parse(t),CRX.path={type:"list",page:2,pageSize:16,hashNext:t.hashNext,typeid:a};for(var i=t.pluginList.length,r=0;r<i;r++)for(var l=t.pluginList[r].appid,s=0;s<o.length;s++)o[s]===l&&(t.pluginList[r].install=!0);var c=new n(e.one("#app_tmpl").html()).render(t);if(e.one("#J_Category").html(c),setTimeout(function(){var e=KISSY.DOM.query("#J_Category .single-con");util.defaultCalGrade(e)},10),window.carousel_main&&window.carousel_main.stop(),e.all("#J_Main .main-lists").hide(),e.one("#J_Category").show(),CRX.path.loaded=!0,t.hashNext===!0){var u=h.viewportHeight(),d=e.one("#J_Main").height(),p=h.scrollTop();d<p+u-70&&CRX.update()}e.one("#J_Category")[0].appendChild(util.insertFootTipsNode(t.hashNext)),util.positionFooter()}}),util.positionFooter()},viewdetail:function(t){null===CRX.curDetailItem&&(CRX.curDetailStatus=!0,this.defaultroute()),window.carousel&&window.carousel.stop(),0==e.one("#J_Main").height()&&(document.getElementById("J_Recommend").style.display="block",util.positionFooter()),e.one("#J_Popup").hide();var i=t.id,o=CRX.api("plugin")+"?appid="+i+"&t="+e.now(),r=CRX.lists;e.io({url:o,type:"get",success:function(t){if(t=e.JSON.parse(t),t.pluginList[0]){var i=CATEGORYCN[t.pluginList[0].type];t.pluginList[0].category=i;for(var o=t.pluginList[0].appid,l=0;l<r.length;l++)r[l]===o&&(t.pluginList[0].install=!0);var s=new n(e.one("#detail_tmpl").html()).render(t);e.one("#J_PopupCon").html(s),window.carousel&&window.carousel.destroy();var c=t.pluginList[0].detailsPhotosList.length,d=e.all("#J_PopupSlide span");if(c>1){var p=a.Carousel;window.carousel=new p("#J_PopupSlide",{effect:"scrollx",viewSize:[546],prevBtnCls:"prev",nextBtnCls:"next",autoplay:!0,interval:3,switchTo:0}),window.carousel.nav.style.marginLeft=(0-24*window.carousel.length)/2+"px",d.show()}else d.hide();setTimeout(function(){util.appCalGrade(document.getElementById("J_PopupCon"),t.pluginList[0].appid)},10),e.one("#J_Popup").show();var h=u.docHeight();DOM.css("#J_Popup",{height:h})}else alert("未查询到该扩展！")}})},viewmy:function(){return window.carousel&&window.carousel.stop(),window.popupHide?void(window.popupHide=!1):(document.body.scrollTop=0,CRX.curActiveHash="-2",e.one("#J_Popup").hide(),setMovingBar(-2),e.one("#J_Search_input").val(""),e.one("#J_Search").addClass("init"),e.one("#J_Search").addClass("init-after"),void setTimeout(function(){chrome.management.getAll(function(t){t.sort(function(e,t){return e.name.localeCompare(t.name)});for(var a=[],i=0;i<t.length;i++)if(!t[i].isApp&&"theme"!==t[i].type){if(t[i].icons){var o=t[i].icons.length;t[i].icon=t[i].icons[o-1].url}else t[i].icon=util.setIcon(t[i].id);a.push(t[i])}if(a.length>0){var r=new n(e.one("#my_app").html()).render({extensions:a});e.one("#J_MyExtensions").removeClass("no-extensions"),e.one("#J_MyExtensions").html(r+entryDevMode);var l=KISSY.DOM.query("#J_MyExtensions .mod-single");util.defaultCalGrade(l)}else e.io({url:CRX.tmsApi.url,dataType:"jsonp",jsonp:"callback",success:function(t){var a=t[CRX.tmsApi.id].value||{},i=a.extension_recommend||[];e.one("#J_Result").addClass("no-result"),i=util.calGrade(util.ascendSort(i,"position"));var o=CRX.getArrayItem(i,8);o=new n(e.one("#recommend_tmpl").html()).render({pluginList:o}),o=util.insertNoInstallExtNode(o),e.one("#J_MyExtensions").addClass("no-extensions"),e.one("#J_MyExtensions").html(o),util.positionFooter()},error:function(e){}});window.carousel_main&&window.carousel_main.stop(),e.all("#J_Main .main-lists").hide(),e.one("#J_MyExtensions").show();for(var s=CRX.api("plugin"),c=e.all("#J_MyExtensions p"),u=function(){for(var n=[],i=0;i<a.length;i++){var o=s+"?appid="+a[i].id+"&t="+e.now();n[i]=function(t,n,a){return function(){e.io({url:n,type:"get",async:!1,success:function(t){t=e.JSON.parse(t),t.pluginList[0]&&(c[a].innerHTML=t.pluginList[0].summary),util.positionFooter()}})}}(t[i],o,i)}return n},d=u(),i=0;i<d.length;i++)d[i]();util.positionFooter()})},230))},defaultroute:function(i){if(window.carousel&&window.carousel.stop(),window.carousel_main&&window.carousel_main.stop(),window.popupHide)return void(window.popupHide=!1);document.body.scrollTop=0,CRX.curActiveHash="0",e.one("#J_Popup").hide(),setMovingBar(0),e.one("#J_Search_input").val(""),e.one("#J_Search").addClass("init"),e.one("#J_Search").addClass("init-after"),CRX.curDetailStatus||t.Router.navigate("hot/recommendation");var o=CRX.tmsApi.id,r=CRX.tmsApi.url;CRX.lists;e.io({url:r,dataType:"jsonp",jsonp:"callback",success:function(t){var i=t[o].value||{},r=i.carousel_ext||[],l=i.rank_list&&i.rank_list.length>0?i.rank_list[0]:{},s=i.extension_category||[];e.all("#J_Main .main-lists").hide(),e.one("#J_Recommend").show(),r=util.calGrade(util.ascendSort(r,"position"));var c=new n(e.one("#app_slider").html()).render({sliders:r});e.one("#J_Slide_box").html(c);var u=a.Carousel,d=e.one("#J_Rank_box");if(l.is_tms_rank_switch){l.week_rank_list=util.calGrade(util.reduceSort(l.week_rank_list,"num").slice(0,10));var p=new n(e.one("#app_rank").html()).render({rankList:l.week_rank_list});l.month_rank_list=util.calGrade(util.reduceSort(l.month_rank_list,"num").slice(0,10));var h=new n(e.one("#app_rank").html()).render({rankList:l.month_rank_list});d.children(".recommend-rank").remove(),d.append(p),d.append(h),d.one(".recommend-rank").addClass("active")}else console.log("向服务端请求排行榜数据"),l={};s=util.ascendSort(s,"category_position"),s.forEach(function(e,t){s[t].category_arr=util.calGrade(util.ascendSort(s[t].category_arr,"position").slice(0,3))});var g=new n(e.one("#app_category").html()).render({categoryList:s});e.one("#J_Category_box").html(g);var m="轮播图",v=e.all("#J_Slide span");
r.length>1?(window.carousel_main=new u("#J_Slide",{effect:"fade",prevBtnCls:"prev",nextBtnCls:"next",hasTriggers:!0,autoplay:!0}),Event.on(".J_Slide-prev","click",function(){util.log({ck_name:m,ck_rg:"prev"})}),Event.on(".J_Slide-next","click",function(){util.log({ck_name:m,ck_rg:"next"})}),v.show(),window.carousel_main.start()):v.hide(),util.positionFooter()}})},defaultFn:function(e){if(window.popupHide)return void(window.popupHide=!1);if(document.body.scrollTop=0,/^search=/.test(e.actions)){var t=window.location.hash;t=t.replace("#!search=",""),this.viewsearch({keyword:t})}util.positionFooter()}},{ATTRS:{routes:{value:{"":"defaultroute","/":"defaultroute","hot/:hot":"defaultroute","my/:extensions":"viewmy","search=:keyword":"viewsearch","category/:type":"viewcategory","detail/:id":"viewdetail","*actions":"defaultFn"}}}}),p},{requires:["mvc","xtemplate","switchable","CrxModel","CrxView","CrxCollection","SearchView","CategoryView","DetailView","DetailExtView","MyappView"]}),S.use("event,anim",function(e,t,n){e.ready(function(e){t.on("#J_goTop","click",function(e){var t=new n("body","scrollTop:0px",.2);t.run(),util.log({ck_name:"右侧电梯",ck_rg:"返回顶部"})})})}),E.on(window,"scroll",function(e){util.goTop()}),window.onmousewheel=function(e){if(document.getElementById("J_Popup").contains(e.target))return e.stopPropagation(),e.preventDefault(),!1},window.onload=function(){var e="首部导航";util.pageLog(),util.goTop(),Event.on(".logo","click",function(){util.log({ck_name:e,ck_rg:"logo"})}),Event.on("#J_Menu li","click",function(t){util.log({ck_name:e,ck_rg:CATEGORYCN[t.currentTarget.dataset.id]})}),Event.on("#J_Menu_my","click",function(){util.log({ck_name:e,ck_rg:"我的扩展"})})};